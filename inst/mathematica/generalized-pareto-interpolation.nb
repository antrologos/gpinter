(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23765,        617]
NotebookOptionsPosition[     22015,        553]
NotebookOutlinePosition[     22374,        569]
CellTagsIndexPosition[     22331,        566]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Generalized Pareto interpolation", "Title",
 CellChangeTimes->{{3.687091159491653*^9, 3.687091165233736*^9}}],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell["The problem", "Section",
 CellChangeTimes->{{3.687091256462698*^9, 3.687091259829566*^9}}],

Cell[TextData[{
 "We have a distribution of income (or wealth) for which we know only, for K \
values ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", "\[Ellipsis]", ",", 
    SubscriptBox["p", "K"]}], TraditionalForm]]],
 " in [0, 1], the corresponding quantiles ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], ",", "\[Ellipsis]", ",", 
    SubscriptBox["q", "K"]}], TraditionalForm]]],
 " and the truncated mean above ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "1"], ",", "\[Ellipsis]", ",", 
    SubscriptBox["m", "K"]}], TraditionalForm]]],
 " (which can be easily obtained from top shares or average within brackets). \
Formally:"
}], "Text",
 CellChangeTimes->{{3.684673303612616*^9, 3.6846733197305403`*^9}, {
  3.6846733710610247`*^9, 3.6846734650814457`*^9}, {3.6846735498908157`*^9, 
  3.684673671454286*^9}, {3.684679950595381*^9, 3.6846799670929956`*^9}, {
  3.6870912745483637`*^9, 3.687091314978608*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["m", "k"], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     SubscriptBox["p", "k"], "1"], 
    RowBox[{
     RowBox[{"Q", "(", "u", ")"}], 
     RowBox[{"\[DifferentialD]", "u"}]}]}]}], TraditionalForm]]]], "Text",
 CellChangeTimes->{{3.6846799910134287`*^9, 3.68468001329011*^9}},
 TextAlignment->Center],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "(", "u", ")"}], TraditionalForm]]],
 " is the quantile function. Also define ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "(", ".", ")"}], TraditionalForm]]],
 " the function:"
}], "Text",
 CellChangeTimes->{{3.684680050842389*^9, 3.684680071635808*^9}, {
  3.684680107017538*^9, 3.684680128371708*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"M", "(", "p", ")"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "p", "1"], 
    RowBox[{
     RowBox[{"Q", "(", "u", ")"}], 
     RowBox[{"\[DifferentialD]", "u"}]}]}]}], TraditionalForm]]]], "Text",
 CellChangeTimes->{{3.684680155907995*^9, 3.684680177369589*^9}},
 TextAlignment->Center],

Cell[TextData[{
 "We wish to reconstruct both functions ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox["Q", TraditionalForm]]],
 " based on the information at our disposal."
}], "Text",
 CellChangeTimes->{{3.684680229098681*^9, 3.684680285412923*^9}, {
  3.684680362544722*^9, 3.6846803694963837`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Direct interpolation", "Section",
 CellChangeTimes->{{3.687091340381957*^9, 3.68709134398037*^9}}],

Cell["Using the definition of M:", "Text",
 CellChangeTimes->{3.684680387017891*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", "[", "p_", "]"}], "=", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", "p", "1"], 
    RowBox[{
     RowBox[{"Q", "[", "u", "]"}], 
     RowBox[{"\[DifferentialD]", "u"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6846802879313*^9, 3.6846803045218277`*^9}}],

Cell[TextData[{
 "we can see that the derivatives of ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]]],
 " are given by the quantile function:"
}], "Text",
 CellChangeTimes->{{3.684680320009734*^9, 3.6846803524940567`*^9}, {
  3.684680389808873*^9, 3.684680391087368*^9}, {3.684756467158242*^9, 
  3.6847564678284273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"M", "[", "p", "]"}], ",", "p"}], "]"}]], "Input",
 CellChangeTimes->{{3.68468043454335*^9, 3.684680437956994*^9}, {
  3.685176555088633*^9, 3.6851765594565*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Q", "[", "p", "]"}]}]], "Output",
 CellChangeTimes->{
  3.684680438545978*^9, 3.6846809060535917`*^9, 3.6846810432943287`*^9, {
   3.684681249415553*^9, 3.684681282981737*^9}, 3.68468139927413*^9, 
   3.684681750492702*^9, 3.684681832415781*^9, 3.684681884982671*^9, 
   3.684682054938272*^9, {3.6846821557456837`*^9, 3.684682208553371*^9}, 
   3.6846822748127213`*^9, 3.684682332190363*^9, 3.684682371728106*^9, 
   3.684682416204423*^9, 3.684682678944586*^9, 3.684684859660346*^9, 
   3.684685864254026*^9, 3.684728180432425*^9, {3.684728768070615*^9, 
   3.68472879235347*^9}, 3.684744855538003*^9, 3.684745087482758*^9, 
   3.684745219931801*^9, 3.684745307423936*^9, 3.6847536681213408`*^9, 
   3.684754586824415*^9, 3.684755267979103*^9, 3.6847564690274467`*^9, 
   3.6847580241203127`*^9, 3.684775026617381*^9, 3.6848140491605377`*^9, 
   3.684822844495315*^9, 3.6848245991546993`*^9, 3.684834313680457*^9, 
   3.6848347658826*^9, 3.6848385881391687`*^9, 3.6848485654381104`*^9, 
   3.6849070182015142`*^9, 3.684939762856797*^9, 3.684944024818976*^9, 
   3.684989840300054*^9, {3.6851765517223463`*^9, 3.68517655985014*^9}, 
   3.685347103473604*^9, 3.685631769980397*^9, {3.685678807416903*^9, 
   3.685678834060166*^9}, 3.685679150587706*^9, 3.6856805171524057`*^9, 
   3.685680859153949*^9, 3.68568459426551*^9, 3.6856915842431707`*^9, 
   3.6856927073191853`*^9, 3.6857638967964907`*^9, 3.685807999163389*^9, 
   3.687091422069976*^9, 3.687091594787416*^9}]
}, Open  ]],

Cell[TextData[{
 "which makes it quite easy to interpolate ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]]],
 " using, say, Hermite splines. However, because the function ",
 Cell[BoxData[
  FormBox["M", TraditionalForm]]],
 " is quite ill-behaved, a direct interpolation would yield disapointing \
results, especially at the top of the distribution."
}], "Text",
 CellChangeTimes->{{3.684680510331305*^9, 3.6846805739363747`*^9}, {
  3.68468060442901*^9, 3.684680643793538*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generalized Pareto interpolation", "Section",
 CellChangeTimes->{{3.687091370387261*^9, 3.687091377529522*^9}}],

Cell[TextData[{
 "A better approach is to use some kind of logarithmic transform of the \
function. So we consider the function ",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]]],
 " defined by:"
}], "Text",
 CellChangeTimes->{{3.684680657380114*^9, 3.6846806995183477`*^9}, {
  3.684681359664386*^9, 3.6846813931862907`*^9}, {3.684682236537327*^9, 
  3.68468223892135*^9}, {3.6846847544736557`*^9, 3.684684754609489*^9}, {
  3.6870914399394207`*^9, 3.6870914430258512`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Log", "[", 
   RowBox[{"M", "[", 
    RowBox[{"1", "-", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684680701256281*^9, 3.684680719534506*^9}, 
   3.6846810196030188`*^9, {3.684681242348523*^9, 3.684681244311253*^9}, {
   3.684681395847106*^9, 3.684681395990156*^9}, {3.6846822255995903`*^9, 
   3.684682233222505*^9}, {3.6870914516281347`*^9, 3.68709145482766*^9}, {
   3.6870915659081907`*^9, 3.6870915668089247`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"Log", "[", 
   RowBox[{
    SubsuperscriptBox["\[Integral]", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "x"}]]}], "1"], 
    RowBox[{
     RowBox[{"Q", "[", "u", "]"}], 
     RowBox[{"\[DifferentialD]", "u"}]}]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.6846822748404093`*^9, 3.684682332217319*^9, 3.684682371775176*^9, 
   3.684682416228465*^9, 3.6846826789810143`*^9, 3.6846848596851873`*^9, 
   3.684685864278653*^9, 3.684728180469939*^9, {3.6847287681211576`*^9, 
   3.684728792406951*^9}, 3.68474485559489*^9, 3.684745087526688*^9, 
   3.6847452199729*^9, 3.684745307464172*^9, 3.684753668162418*^9, 
   3.684754586938303*^9, 3.684755268040183*^9, 3.684756471431116*^9, 
   3.684758024167657*^9, 3.684775026657797*^9, 3.684814049199521*^9, 
   3.684822844535359*^9, 3.684824599204803*^9, 3.684834313715198*^9, 
   3.6848347659213877`*^9, 3.684838588219713*^9, 3.6848485654737463`*^9, 
   3.6849070182490807`*^9, 3.684939762900799*^9, 3.684944024855249*^9, 
   3.684989840379228*^9, 3.68517657061357*^9, 3.685347103512766*^9, 
   3.685631770025537*^9, {3.685678807460692*^9, 3.685678834112609*^9}, 
   3.685679150640595*^9, 3.6856805172074957`*^9, 3.685680859201873*^9, 
   3.685684594346006*^9, 3.685691584322336*^9, 3.6856927074038973`*^9, 
   3.6857638968366737`*^9, 3.685807999203821*^9, 3.687091422109337*^9, 
   3.68709145690595*^9, 3.687091594831202*^9}]
}, Open  ]],

Cell["\<\
In the case of a pure Pareto distribution, that function is exactly linear:\
\>", "Text",
 CellChangeTimes->{{3.684680744985703*^9, 3.684680767303701*^9}, {
  3.684680801648232*^9, 3.684680823607225*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        RowBox[{"M", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Q", "[", "p_", "]"}], "\[Rule]", 
        RowBox[{"\[Mu]", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", "p"}], ")"}], 
          RowBox[{"1", "/", "\[Alpha]"}]]}]}], "}"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]", ">", "1"}], ",", 
        RowBox[{"x", ">", "0"}]}], "}"}]}]}], "]"}], ",", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6846808616274757`*^9, 3.684680985896349*^9}, {
   3.684681016219397*^9, 3.684681036020327*^9}, {3.68468127104226*^9, 
   3.684681279717*^9}, 3.6846822965699863`*^9, {3.6870914655874434`*^9, 
   3.687091468753606*^9}, {3.68709157821842*^9, 3.687091579032729*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox["1", "\[Alpha]"]}], ")"}]}], "-", 
  RowBox[{"Log", "[", 
   FractionBox[
    RowBox[{"\[Alpha]", " ", "\[Mu]"}], 
    RowBox[{"1", "+", "\[Alpha]"}]], "]"}]}]], "Output",
 CellChangeTimes->{{3.684680867796257*^9, 3.684680986553302*^9}, 
   3.684681043692584*^9, {3.684681249868101*^9, 3.684681283447474*^9}, 
   3.6846813998094473`*^9, 3.6846817508611307`*^9, 3.68468183278609*^9, 
   3.684681885356016*^9, 3.684682055343897*^9, {3.684682156127389*^9, 
   3.684682208933951*^9}, 3.68468227488282*^9, 3.6846823326724653`*^9, 
   3.684682372136018*^9, 3.684682416581006*^9, 3.684682679346085*^9, 
   3.684684860045833*^9, 3.6846858646358547`*^9, 3.684728181403619*^9, {
   3.684728768882371*^9, 3.684728793157902*^9}, 3.684744856550352*^9, 
   3.684745088339209*^9, 3.684745220806881*^9, 3.684745308271007*^9, 
   3.684753669018489*^9, 3.6847545877870817`*^9, 3.684755269078651*^9, 
   3.684756474877612*^9, 3.684758025081992*^9, 3.6847750276690607`*^9, 
   3.684814050184701*^9, 3.684822845398828*^9, 3.684824600063644*^9, 
   3.684834314712879*^9, 3.68483476678959*^9, 3.684838589098975*^9, 
   3.684848566552462*^9, 3.6849070192175903`*^9, 3.6849397637491703`*^9, 
   3.684944025824806*^9, 3.684989841342638*^9, {3.685176567919219*^9, 
   3.685176572973143*^9}, 3.685347104475766*^9, 3.685631770981333*^9, {
   3.6856788084374437`*^9, 3.6856788349020967`*^9}, 3.6856791514257708`*^9, 
   3.685680518084588*^9, 3.685680860051569*^9, 3.6856845953199244`*^9, 
   3.68569158523538*^9, 3.685692708294237*^9, 3.685763897856721*^9, 
   3.685808000161642*^9, 3.6870914230718412`*^9, 3.687091469685834*^9, 
   3.6870915956354017`*^9}]
}, Open  ]],

Cell[TextData[{
 "So if the distribution id approximately Paretian, then ",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]]],
 " should be approximately linear. Therefore the interpolation will work much \
better. The derivative of the function ",
 Cell[BoxData[
  FormBox["\[Phi]", TraditionalForm]]],
 " can be written:"
}], "Text",
 CellChangeTimes->{{3.6846810606900253`*^9, 3.684681141157539*^9}, {
  3.684681405818894*^9, 3.684681422331574*^9}, {3.6846815289471197`*^9, 
  3.6846815319147587`*^9}, {3.687091479829651*^9, 3.687091487451252*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d\[Phi]dx", "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Log", "[", 
       RowBox[{"M", "[", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}], ",", "x"}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "x"}]]}], "1"], 
      RowBox[{
       RowBox[{"Q", "[", "u", "]"}], 
       RowBox[{"\[DifferentialD]", "u"}]}]}], "\[Rule]", 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       RowBox[{"\[Phi]", "[", "x", "]"}]}], "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.6846814296240873`*^9, 3.68468145426431*^9}, {
  3.684681525885524*^9, 3.684681577793494*^9}, {3.684681648947318*^9, 
  3.684681682609235*^9}, {3.684681746110264*^9, 3.684681746511773*^9}, {
  3.684681791182828*^9, 3.684681791528124*^9}, {3.6846822048594723`*^9, 
  3.684682205695614*^9}, {3.68468224759249*^9, 3.684682270980919*^9}, {
  3.684682310064019*^9, 3.6846823276778584`*^9}, {3.684685804646667*^9, 
  3.684685810374196*^9}, {3.684685859033503*^9, 3.684685860384715*^9}, {
  3.684756454632627*^9, 3.684756454838825*^9}, {3.6851765771426*^9, 
  3.685176593282494*^9}, {3.687091491734455*^9, 3.687091495879624*^9}, {
  3.687091555999564*^9, 3.687091557975719*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "x"}], "+", 
    RowBox[{"\[Phi]", "[", "x", "]"}]}]], " ", 
  RowBox[{"Q", "[", 
   RowBox[{"1", "-", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "x"}]]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.6846814334277687`*^9, 3.6846814751227627`*^9, {3.684681549921369*^9, 
   3.6846815782018757`*^9}, {3.684681664478095*^9, 3.6846816830581217`*^9}, 
   3.684681750919025*^9, 3.68468183282718*^9, 3.6846818853939133`*^9, 
   3.684682055383412*^9, {3.684682156173026*^9, 3.6846822089743147`*^9}, 
   3.684682274933323*^9, 3.684682332738864*^9, 3.6846823721743603`*^9, 
   3.684682416626863*^9, 3.684682679385022*^9, 3.684684860107513*^9, 
   3.684685810926752*^9, {3.684685861093066*^9, 3.684685864671793*^9}, 
   3.68472818177663*^9, {3.684728769015287*^9, 3.684728793269528*^9}, 
   3.6847448567445803`*^9, 3.684745088575365*^9, 3.684745220945095*^9, 
   3.6847453084160423`*^9, 3.6847536691841793`*^9, 3.684754588003487*^9, 
   3.6847552694123697`*^9, 3.6847564769401627`*^9, 3.684758025301701*^9, 
   3.684775027998144*^9, 3.684814050416918*^9, 3.684822845579072*^9, 
   3.6848246001982327`*^9, 3.684834315051827*^9, 3.684834767025392*^9, 
   3.684838589297865*^9, 3.684848566955491*^9, 3.684907019480736*^9, 
   3.684939763851201*^9, 3.68494402624025*^9, 3.684989841537231*^9, 
   3.685176593646778*^9, 3.685347104723857*^9, 3.6856317714892683`*^9, {
   3.685678808702565*^9, 3.685678834991702*^9}, 3.685679151526269*^9, 
   3.685680518207467*^9, 3.6856808601693163`*^9, 3.685684595547014*^9, 
   3.6856915854788237`*^9, 3.685692708418672*^9, 3.6857638982149277`*^9, 
   3.685808000459737*^9, 3.687091423387308*^9, {3.6870914987688923`*^9, 
   3.687091520123385*^9}, 3.687091558648531*^9, 3.687091595734376*^9}]
}, Open  ]],

Cell[TextData[{
 "We can still calculate it at the interpolation points from the data. \
Importantly, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Q", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["e", 
      RowBox[{"-", "x"}]]}], "]"}], TraditionalForm]]],
 " is equal to:"
}], "Text",
 CellChangeTimes->{{3.68468170562577*^9, 3.6846817240639563`*^9}, {
   3.684681843814502*^9, 3.68468186022164*^9}, 3.684681892390005*^9, {
   3.684684774159122*^9, 3.684684775213996*^9}, {3.6846848288070517`*^9, 
   3.6846848438038692`*^9}, {3.684686045348113*^9, 3.6846860453481483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"L", "=", 
  RowBox[{
   RowBox[{"Q", "[", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]]}], "]"}], "/.", 
   RowBox[{"First", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"d\[Phi]dx", "\[Equal]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"\[Phi]", "[", "x", "]"}], ",", "x"}], "]"}]}], ",", 
      RowBox[{"Q", "[", 
       RowBox[{"1", "-", 
        RowBox[{"Exp", "[", 
         RowBox[{"-", "x"}], "]"}]}], "]"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.684681793681738*^9, 3.6846818273591003`*^9}, {
  3.684681863350601*^9, 3.6846818821997347`*^9}, {3.6846820381865377`*^9, 
  3.684682050975349*^9}, {3.6846821670257998`*^9, 3.6846821700407677`*^9}, {
  3.684682650298596*^9, 3.684682671490024*^9}, {3.684684852673119*^9, 
  3.684684853524469*^9}, {3.684756458527729*^9, 3.684756458638418*^9}, {
  3.685176598733275*^9, 3.685176602557621*^9}, {3.687091531297668*^9, 
  3.687091540876953*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"x", "-", 
    RowBox[{"\[Phi]", "[", "x", "]"}]}]], " ", 
  RowBox[{
   SuperscriptBox["\[Phi]", "\[Prime]",
    MultilineFunction->None], "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{{3.684681827854549*^9, 3.6846818328758583`*^9}, 
   3.6846818854304533`*^9, 3.684682055430863*^9, {3.684682156192972*^9, 
   3.684682209008112*^9}, 3.684682274964801*^9, 3.68468233276999*^9, 
   3.684682372225774*^9, 3.6846824166610327`*^9, {3.6846826521598597`*^9, 
   3.684682679434091*^9}, 3.684684860142002*^9, 3.6846858183530273`*^9, 
   3.6846858646923647`*^9, 3.684728181799176*^9, {3.684728769037179*^9, 
   3.6847287933073463`*^9}, 3.6847448567932053`*^9, 3.68474508864791*^9, 
   3.6847452209907713`*^9, 3.684745308499298*^9, 3.684753669235177*^9, 
   3.684754588052507*^9, 3.684755269461767*^9, 3.684756479655292*^9, 
   3.6847580253851337`*^9, 3.6847750280223846`*^9, 3.684814050465814*^9, 
   3.684822845619113*^9, 3.6848246002484093`*^9, 3.6848343151701508`*^9, 
   3.684834767123255*^9, 3.684838589369567*^9, 3.684848567017003*^9, 
   3.684907019502479*^9, 3.6849397638732*^9, 3.6849440262728033`*^9, 
   3.6849898415785837`*^9, 3.6851766029077587`*^9, 3.685347104765328*^9, 
   3.6856317715351954`*^9, {3.6856788087275476`*^9, 3.685678835020615*^9}, 
   3.685679151575266*^9, 3.685680518259095*^9, 3.6856808602214518`*^9, 
   3.685684595594693*^9, 3.685691585536151*^9, 3.685692708469356*^9, 
   3.685763898369831*^9, 3.685808000509983*^9, 3.68709142345686*^9, 
   3.6870915957821617`*^9}]
}, Open  ]],

Cell[TextData[{
 "Its derivative must of course be positive, hence we have the following \
restriction on ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]]],
 ":"
}], "Text",
 CellChangeTimes->{{3.68468189871763*^9, 3.684681927212737*^9}, {
  3.6846847841972733`*^9, 3.684684784778529*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"L", ",", "x"}], "]"}], ">", "0"}], ",", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"x", "-", 
     RowBox[{"\[Phi]", "[", "x", "]"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.684681932170958*^9, 3.6846819390472193`*^9}, {
  3.684682337478598*^9, 3.684682364811729*^9}, {3.684682674525278*^9, 
  3.684682674857849*^9}, {3.684684855536953*^9, 3.684684856196416*^9}, {
  3.685176607692791*^9, 3.685176611804871*^9}, {3.6870915872962837`*^9, 
  3.687091591581606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"x", "-", 
     RowBox[{"\[Phi]", "[", "x", "]"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["\[Phi]", "\[Prime]",
          MultilineFunction->None], "[", "x", "]"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["\[Phi]", "\[Prime]",
        MultilineFunction->None], "[", "x", "]"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[Phi]", "\[Prime]\[Prime]",
       MultilineFunction->None], "[", "x", "]"}]}], ")"}]}], ">", 
  "0"}]], "Output",
 CellChangeTimes->{
  3.684681939553636*^9, 3.6846820555133533`*^9, {3.684682156243074*^9, 
   3.684682209024667*^9}, 3.684682274982691*^9, {3.6846823327875433`*^9, 
   3.684682372273847*^9}, 3.684682416693232*^9, 3.684682679464301*^9, 
   3.684684860188233*^9, 3.684685822533697*^9, 3.684685864723974*^9, 
   3.684728181836192*^9, {3.68472876907082*^9, 3.6847287933562813`*^9}, 
   3.684744856843855*^9, 3.684745088763823*^9, 3.6847452210414143`*^9, 
   3.684745308582808*^9, 3.684753669286255*^9, 3.6847545881032877`*^9, 
   3.68475526951066*^9, 3.684756482131859*^9, 3.684758025468959*^9, 
   3.68477502807135*^9, 3.684814050515835*^9, 3.684822845668119*^9, 
   3.6848246003012133`*^9, 3.6848343152520733`*^9, 3.684834767274412*^9, 
   3.6848385894863777`*^9, 3.684848567039193*^9, 3.684907019551168*^9, 
   3.6849397639180117`*^9, 3.684944026304335*^9, 3.68498984162831*^9, 
   3.685176612172906*^9, 3.685347104815621*^9, 3.685631771585581*^9, {
   3.685678808779159*^9, 3.68567883506391*^9}, 3.685679151625366*^9, 
   3.685680518308805*^9, 3.6856808602714653`*^9, 3.685684595644435*^9, 
   3.68569158556851*^9, 3.685692708519177*^9, 3.685763898515836*^9, 
   3.6858080005577993`*^9, 3.687091423487949*^9, 3.6870915958292017`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 708},
WindowMargins->{{298, Automatic}, {Automatic, 30}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 115, 1, 92, "Title"],
Cell[698, 25, 76, 1, 28, "Input"],
Cell[CellGroupData[{
Cell[799, 30, 96, 1, 64, "Section"],
Cell[898, 33, 984, 26, 72, "Text"],
Cell[1885, 61, 382, 11, 41, "Text"],
Cell[2270, 74, 373, 12, 31, "Text"],
Cell[2646, 88, 362, 10, 40, "Text"],
Cell[3011, 100, 343, 10, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3391, 115, 104, 1, 64, "Section"],
Cell[3498, 118, 84, 1, 30, "Text"],
Cell[3585, 121, 313, 9, 49, "Input"],
Cell[3901, 132, 325, 8, 31, "Text"],
Cell[CellGroupData[{
Cell[4251, 144, 218, 5, 28, "Input"],
Cell[4472, 151, 1508, 23, 28, "Output"]
}, Open  ]],
Cell[5995, 177, 482, 11, 50, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6514, 193, 117, 1, 64, "Section"],
Cell[6634, 196, 481, 10, 51, "Text"],
Cell[CellGroupData[{
Cell[7140, 210, 526, 11, 28, "Input"],
Cell[7669, 223, 1452, 27, 47, "Output"]
}, Open  ]],
Cell[9136, 253, 214, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[9375, 261, 1067, 29, 56, "Input"],
Cell[10445, 292, 1729, 30, 48, "Output"]
}, Open  ]],
Cell[12189, 325, 555, 12, 53, "Text"],
Cell[CellGroupData[{
Cell[12769, 341, 1413, 33, 47, "Input"],
Cell[14185, 376, 1816, 31, 34, "Output"]
}, Open  ]],
Cell[16016, 410, 576, 14, 31, "Text"],
Cell[CellGroupData[{
Cell[16617, 428, 1010, 24, 35, "Input"],
Cell[17630, 454, 1566, 26, 32, "Output"]
}, Open  ]],
Cell[19211, 483, 291, 8, 31, "Text"],
Cell[CellGroupData[{
Cell[19527, 495, 575, 13, 35, "Input"],
Cell[20105, 510, 1870, 38, 66, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
